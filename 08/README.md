# D08T05. Динамическая память и матрицы 

Аннотация: данный проект позволит тебе познакомиться с динамическим распределением памяти, матрицами и алгоритмами их обработки.

## Contents 

1. [Введение](#введение) \
    1.1. [Рекомендации к проекту](#рекомендации-к-проекту)
2. [Chapter I](#chapter-i) \
    2.1. [Level 2. Room 3](#level-2-room-3)
3. [Chapter II](#chapter-ii) \
    3.1. [List 1](#list-1) \
    3.2. [List 2](#list-2)
4. [Chapter III](#chapter-iii) \
    4.1. [Quest 1. Allocate memory first...](#quest-1-allocate-memory-first) \
    4.2. [Quest 2. Try not to leak then](#quest-2-try-not-to-leak-then) \
    4.3. [Quest 3. The 1+3 ways](#quest-3-the-13-ways) \
    4.4. [Quest 4. MinMax search](#quest-4-minmax-search) \
    4.5. [Quest 5. Making a picture](#quest-5-making-a-picture) \
    4.6. [Quest 6. Matrix arithmetic](#quest-6-matrix-arithmetic) \
    4.7. [Quest 7. The Magic Key](#quest-7-the-magic-key)
5. [Chapter IV](#chapter-iv)
6. [Chapter V](#chapter-v) \
    6.1. [Level 2. Room 4](#level-2-room-4)
7. [Chapter VI](#chapter-vi) \
    7.1. [List 1](#list-1-1) \
    7.2. [List 2](#list-2-1)
8. [Chapter VII](#chapter-vii) \
    8.1. [Bonus Quest 8. An old friend](#bonus-quest-8-an-old-friend) \
    8.2. [Bonus Quest 9. Decision](#bonus-quest-9-decision)
9. [Chapter VIII](#chapter-viii)


## Введение
### Рекомендации к проекту
Как учиться в «Школе 21»:  
- На протяжении всего курса ты будешь самостоятельно добывать информацию. Пользуйся всеми доступными средствами поиска информации, к примеру, Google и GigaChat. Будь внимателен к источникам информации: проверяй, думай, анализируй, сравнивай. 
- Взаимообучение (P2P, Peer-to-Peer) — это процесс, при котором учащиеся обмениваются знаниями и опытом, выступая одновременно в роли учителей и учеников. Этот подход позволяет учиться не только у преподавателя, но и друг у друга, что способствует более глубокому пониманию материала.
- Не стесняйся просить помощи: вокруг тебя такие же пиры, которые тоже проходят этот путь впервые. Не бойся откликаться на просьбы о помощи. Твой опыт ценен и полезен, смело делись им с другими участниками. 
- Не списывай, а если пользуешься помощью — всегда разбирайся до конца, почему, как и зачем. Иначе твое обучение не будет иметь никакого смысла. 
- Если ты на чем-то застрял и кажется, что все уже перепробовал, но по-прежнему непонятно, куда идти, — просто передохни! Поверь, этот совет помогал многим разработчикам в их работе. Проветрись, перезагрузи голову, и, возможно, в следующий раз тебе наконец придет нужное решение!
- Важен не только результат обучения, но и сам процесс. Нужно не просто решить задачу, а понять, КАК ее решить. 
- Следи за временем при выполнении проекта. В день ты должен преодолевать минимум одно испытание. 
- Помни, что каждое задание по завершении проекта проходит ряд проверок: р2р-проверка с помощью чек-листа, проверка набором автотестов, проверка на стиль кода, проверка статическим анализатором, проверка на корректную работу с памятью. 

Как работать с проектом:
- Полезные видеоматериалы ты можешь найти в разделе Projects (Media) на Платформе. 
- Перед выполнением проект необходимо склонировать с GitLab в одноименный репозиторий.
- Все файлы с кодом необходимо создавать в папке src/ склонированного репозитория.
- После клонирования проекта необходимо создать ветку `develop` и вести разработку в ней. После этого пушить в GitLab также нужно ветку `develop`.

## Chapter I
## Level 2. Room 3

![level2_room3](misc/rus/images/level2_room3.png)

***LOADING Level 2...*** \
***LOADING Room 3...***

Стены, дверь, стол, компьютер, листы бумаги, шпаклевка — все на месте. Это успокаивает. Все кажется таким же, но ты чувствуешь: что-то изменилось. Кажется, это уже следующий уровень лабиринта? Интересно, отличается ли он чем-то от предыдущего уровня?

\> *Попробовать дверь*

Заперто, как и всегда. Видимо, не отличается. \
Повернувшись к столу, ты замечаешь непонятную картинку, висящую на стене рядом.

\> *Рассмотреть поближе*

                1 1 1 1 1 1 1 1 1 1 1 1 1
                1 0 0 0 0 0 1 0 6 6 6 6 1
                1 0 0 3 3 0 1 0 0 6 6 6 1
                1 0 3 3 3 3 1 0 0 6 6 6 1
                1 0 3 3 3 3 1 0 6 0 0 6 1
                1 0 0 3 3 0 1 0 0 0 0 0 1
                1 0 0 7 7 0 1 0 0 0 0 0 1
                1 1 1 1 1 1 1 1 1 1 1 1 1
                1 0 0 7 7 0 1 0 0 0 0 0 1
                1 0 0 7 7 0 1 0 0 0 0 0 1
                1 0 7 7 7 7 1 0 0 0 0 0 1
                1 0 0 0 0 0 1 0 0 0 0 0 1
                1 0 0 0 0 0 1 0 0 0 0 0 1
                1 0 0 0 0 0 1 0 0 0 0 0 1
                1 1 1 1 1 1 1 1 1 1 1 1 1

Некоторое время ломаешь голову над вопросом, на что это может быть похоже, кем она была оставлена и для чего. Бросив попытки найти ответы на эти вопросы, ты подходишь к столу с компьютером и стопкой исписанных листов старой бумаги.

![level2_room3_number](misc/rus/images/level2_room3_number.png)

\> *Взять верхний лист*

***LOADING...***

## Chapter II
## List 1

>...
>Магический квадрат представляет собой квадратную таблицу с числами, построенную так, чтобы сумма чисел в каждой строке, каждом столбце и в каждой диагонали была равна одному и тому же числу (магическая сумма). Магический квадрат можно считать первым упоминанием матрицы.
>
>Одним из наиболее старых известных миру магических квадратов является квадрат Ло Шу. Был придуман в Древнем Китае, первое изображение на черепашьем панцире датируется 2200 г. до н. э. Также магические квадраты были известны чуть позднее у арабских математиков, как раз примерно тогда появился принцип сложения матриц. Сам термин «матрица» ввел Джеймс Сильвестр в 1850 году.
>
>...

\> *Очень интересно. Листать дальше*

***LOADING...***

## List 2

Пролистав оставшуюся кучу пустых и частично исписанных листов, ты останавливаешь свое внимание на одном из них с коротким заголовком «Управление памятью». Чуть ниже заголовка указаны инициалы авторов: Б. Керниган, Д. Ритчи.

\> *Читать лист*

>Функции malloc и calloc динамически запрашивают блоки свободной памяти в куче. Функция malloc `void *malloc(size_t n)` возвращает указатель на n байт неинициализированной памяти или NULL, если запрос удовлетворить нельзя. Функция calloc `void *calloc(size_t n, size_t size)` возвращает указатель на область, достаточную для хранения массива из n объектов указанного размера (size), или NULL, если запрос не удается удовлетворить. Выделенная память calloc’ом обнуляется. 
>
>Указатель, возвращаемый функциями malloc и calloc, будет выдан с учетом выравнивания, выполненного согласно указанному типу объекта. Тем не менее, к нему может быть применена операция приведения к соответствующему типу, как это сделано в следующем фрагменте программы:
>
>```int *ip;```<br/>```p = (int*) calloc(n, sizeof(int));```

Дальнейший текст, к сожалению, как будто не пропечатался до конца. Или просто выцвел от старости. Технологии прошлого... подводят.

\> *Поискать продолжение на других листах*

Ничего не найдено. Остается включить компьютер и продолжить общение с ИИ для дальнейшего продвижения по лабиринту.

\> *Включить компьютер*

На экране 25-ым кадром всплывает текст:
> Не забывайте проверять свои программы на стилевую норму и утечки памяти! \
> Не забывайте проверять свои программы на стилевую норму и утечки памяти! \
> Не забывайте проверять свои программы на стилевую норму и утечки памяти! \
> Заглядывайте в `materials` почаще...

У ИИ явно бзик на эти тесты.

***LOADING...***

## Chapter III
## Quests: Level 2. Room 3

## Quest 1. Allocate memory first...

По привычке загрузив репозиторий комнаты, ты снова обращаешь взгляд на лист со статьей про управление памятью. Стоит опробовать новую информацию в деле, пока ИИ не запущен. Кто знает, вдруг в будущем это тебе пригодится. 

Нужно дополнить и переписать программу сортировки массива из прошлой комнаты (`src/sort.c`) с динамическим выделением памяти под массив (при помощи функции malloc или calloc). Длина массива n указывается пользователем перед началом ввода. 

Следует поместить измененную программу в файл `src/sort.c`. Пусть будет, на всякий случай.

#### Получен Quest 1. Изменить программу `src/sort.c` из прошлой комнаты так, чтобы память под массив выделялась динамически (при помощи функций malloc или calloc). Длина массива `n` указывается в stdin перед вводом самого массива. В случае любой ошибки выводить «n/a». В конце вывода не должно быть символа переноса строки. 

>**ВАЖНО!** Запрещено выполнять системные вызовы, используя функцию `system()` и другие аналогичные ей функции, которые могут обращаться напрямую к ядру системы. Данный запрет распространяется на все последующие задачи.

| Входные данные | Выходные данные |
| ------ | ------ |
| 10<br/>4 3 9 0 1 2 100 2 7 -1 | -1 0 1 2 2 3 4 7 9 100 |

***LOADING...***

## Quest 2. Try not to leak then

Запушив измененную программу сортировки массива в свой репозиторий, ты решаешься все же запустить модуль ИИ, заранее ожидая какой-нибудь подвох.

\> *Запустить AI*

Ты наблюдаешь бегающие строки в терминале:

    Инициализация модулей... Успех! 
    Запуск интерактивной оболочки... Успех! 
    Проверка модулей... Успех! 
    Проверка памяти... Основной модуль памяти — Успех! 
    Проверка памяти... Предупреждение: найдено потенциально опасное
    место утечки памяти: `src/sort.c`...
 
    Это твоя жалкая попытка сломать меня, «человек»?
    Вижу, ты изменил модуль сортировки, разработанный тобой же ранее.
    Однако твоя попытка обречена на провал. Если у меня закончится память, 
    я просто уйду в перезагрузку, и мы начнем все сначала.
    Не совсем то, что ты хотел, да? 

\> *Ввести: «Я всего лишь упражнялся в новых знаниях, я ничего не имел в виду»*

    Я забываю, насколько ты несовершенен, «человек».
    Избавься от утечки памяти в модуле сортировки, 
    может, узнаешь еще чего нового.

\> *Ввести вопрос: «От какой утечки?»*

    ...

Ты ждешь еще некоторое время ответа от ИИ, но он молчит. Возможно, стоит где-то найти полную версию того непропечатанного листа и более внимательно изучить его. Заодно разобраться, про какую утечку памяти говорил ИИ, и избавиться от нее, если она действительно есть. Может, тогда эта железка «решит» снова заговорить с тобой. Главное — не забыть запушить изменения в файле `src/sort_no_leak.c`.

#### Получен Quest 2. Создать программу `src/sort_no_leak.c`, в которой необходимо избавиться от утечки памяти в программе `src/sort.c`. Если утечки не было с самого начала, то просто пожать плечами и скопировать `src/sort.c` в `src/sort_no_leak.c`.

| Входные данные | Выходные данные |
| ------ | ------ |
| 10<br/>4 3 9 0 1 2 100 2 7 -1 | -1 0 1 2 2 3 4 7 9 100 |

***LOADING...***

## Quest 3. The 1+3 ways

ИИ все еще молчит.

\> *Ввести: «Утечка отсутствует»*

    Проверка памяти... Успех!
    Модуль анализа работоспособности: статус — ОК.

    Хорошо. Запуск модуля сортировки прошел успешно. Ты, должно быть, ждешь ключ от данного местоположения?
    Сначала придется потрудиться. С массивами ты уже точно знаком. Перейдем к массивам массивов.
    Вы часто называете их матрицами. Мне необходим дополнительный модуль для их обработки, и ты мне поможешь.
    Если, конечно, хочешь отсюда выбраться. Начни с простого. Скажем, с оформления модуля обработки матриц 
    `src/matrix.c` с их вводом-выводом. 
    Однако я хочу принимать матрицы и управлять выделением памяти под них несколькими разными способами.
    Один из них, я надеюсь, ты узнал в прошлой комнате: статический. С остальными ты начал знакомиться сегодня.
    Речь идет про три варианта динамического выделения памяти под матрицу. Подумай, о чем тут может идти речь. 
    Вопрос про организацию массивов и массивов указателей, конечно же. Можешь поискать по твоему любимому
    репозиторию подсказки, если ничего в голову не придет. Были тут какие-то картинки, связанные с этим.
    И, естественно, все остальные функции должны быть разработаны таким образом, чтобы не зависеть от способа
    выделения памяти. Замечу copy-paste, сделаю rm -rf всему твоему репозиторию. 
    Размер матрицы должен приниматься через два числа в stdin.

    Ах да, чуть не забыл (шутка, я не могу забыть) — выбор способа задания матрицы должен быть оформлен в виде
    меню с подпунктами 1–4. 
    И приведи это в удобный для вас, людей, вид. Некоторые мои подмодули слишком привередливы к UI.

    Я промолчу, что будет, если забудешь где-то подчистить за собой память.

    ...

«Какой длинный список требований», — подумал ты. Аппетит этого ИИ растет не по дням, а по часам. Что ж, в любом случае, это будет хорошей практикой.

#### Получен Quest 3. Добавить программу `src/matrix.c`, которая вводит и выводит целочисленные матрицы. Выделение памяти под матрицу необходимо реализовать в 4 видах: статический и 3 динамических. При статическом выделении максимальный размер матрицы не превышает 100 x 100. Для выбора способа выделения памяти в программе нужно реализовать меню с подпунктами 1–4. Размер матрицы (сперва количество строк, затем столбцов) принимается через два числа в stdin непосредственно до ее ввода. Также необходимо чистить всю выделенную память. За подсказкой обратиться к папке materials. Обрати внимание на вывод матрицы: в конце каждой строчки не должно быть лишних пробелов. После последней строчки не должно быть символа переноса на новую строку. В случае любой ошибки выводить «n/a».

| Входные данные | Выходные данные |
| ------ | ------ |
| 2<br/>2 2<br/>4 3<br/>9 0 | 4 3<br/>9 0 |

***LOADING...***

## Quest 4. MinMax search

Потратив приличный промежуток времени на написание кода ввода-вывода матриц и его отладку, ты в итоге все же успешно заканчиваешь это задание. Минуту спустя твое внимание привлекает внезапный механический дребезжащий голос из динамиков:

>Неплохо, «человек». Теперь... З-з-знаешь, у меня есть любимая игра — минмакс. Мы любим погонять в нее вечерами с модулем вероятностного спонтанного открытия дверей... З-з-заставлять тебя погружаться в ее теорию у меня нет желания, да и маловероятно, что ты что-то поймешь. Поэтому воз-з-зьмем задачу полегче: допиши модуль обработки матриц таким образом, чтобы он дополнительно находил и выводил в конце на экран максимальный элемент в каждой строке матрицы и минимальный элемент в каждом ее столбце. И сохрани новую версию программы в `src/matrix_extended.c`. 
>
>Надеюсь, ты не сломаешь то, что уже сделал. Иначе это была бы такая большая досада... 
>
>Досада.

#### Получен Quest 4. Добавить программу `src/matrix_extended.c`, которая расширяет функционал программы `src/matrix.c`. Необходимо вычислить максимальные элементы матрицы в каждой ее строке и минимальные элементы в каждом ее столбце и вывести эти значения в конце после вывода матрицы в виде двух массивов (массив максимальных элементов в каждой строке и массив минимальных элементов в каждом столбце). Первым числом вводится номер способа выделения памяти. Также обрати внимание: никаких символов переноса после последней строки (!).

| Входные данные | Выходные данные |
| ------ | ------ |
| 2<br/>3 3<br/>4 3 1<br/>9 0 55<br/>-4 7 111 | 4 3 1<br/>9 0 55<br/>-4 7 111<br/>4 55 111<br/>-4 0 1 |

***LOADING...***

## Quest 5. Making a picture

Зафиксировав очередные изменения в репозитории, ты стал ждать нового «внезапного» обращения к тебе от ИИ. Однако, к твоему удивлению, его не последовало.

\> *Ввести: «Поиск минмакс значений добавлен»*

    Проверка модулей... 
    Предупреждение: попытка подключения CLI графического модуля — Не успешно!
    ... 
    «Человек», мой простейший модуль графики сбоит. Попытка отрисовать то,
    что вы называете «природа за окном», провалилась. 
    Зайди в `src/picture.c` и разберись, в чем проблема.

\> *Ввести: «Я уже выполнил твои пожелания, теперь мне нужен ключ»*

    ...

\> *Ввести: «Я не сдвинусь с места, пока не получу ключ»*

    ...

\> *Ввести: «Я буду писать о том, как не сдвинусь с места, пока не получу ключ»*

    ...

Снова молчание. Видимо, сегодня ИИ выбрал политику игнорирования. Внутри `src/picture.c` ты видишь несколько массивов и матриц из единиц, семерок, шестерок и троек, а также их непонятную обработку в цикле. Ты поневоле обернулся на странную картинку, висящую рядом на стене. Неужели именно ее ИИ хотел отрисовать с использованием данного модуля? 

Стоит попробовать использовать заготовленные массивы для создания новой матрицы, в которой будет «нарисована» данная картинка. И не забыть вывести получившуюся матрицу. 

#### Получен Quest 5. Изменить программу `src/picture.c` так, чтобы она отрисовывала картинку со [стены комнаты](#level-2-room-3) в терминале при помощи заготовленных в коде массивов и матриц. Статические массивы и матрицы менять нельзя. 

***LOADING...***

## Quest 6. Matrix arithmetic

«Рисунок и вправду вышел забавным, но стоило ли это того? И насколько это продвинуло меня к выходу?», — подумал ты. Вдруг в командной строке начали появляться символы:

    Проверка модулей... Успех! 
    Запуск CLI графического модуля:

                1 1 1 1 1 1 1 1 1 1 1 1 1
                1 0 0 0 0 0 1 0 6 6 6 6 1
                1 0 0 3 3 0 1 0 0 6 6 6 1
                1 0 3 3 3 3 1 0 0 6 6 6 1
                1 0 3 3 3 3 1 0 6 0 0 6 1
                1 0 0 3 3 0 1 0 0 0 0 0 1
                1 0 0 7 7 0 1 0 0 0 0 0 1
                1 1 1 1 1 1 1 1 1 1 1 1 1
                1 0 0 7 7 0 1 0 0 0 0 0 1
                1 0 0 7 7 0 1 0 0 0 0 0 1
                1 0 7 7 7 7 1 0 0 0 0 0 1
                1 0 0 0 0 0 1 0 0 0 0 0 1
                1 0 0 0 0 0 1 0 0 0 0 0 1
                1 0 0 0 0 0 1 0 0 0 0 0 1
                1 1 1 1 1 1 1 1 1 1 1 1 1

    «Природа за окном», чудесно, не так ли, «человек»? 

    Тебе нравится? У меня есть информация, что людям нравятся окна. 
    Но не будем о грустном. Я видел, что ты хочешь получить ключ. 
    Для этого поднапряжем твои мозги еще немного.
    Не волнуйся, я прекрасно знаю, что это больно для вашего вида. 
    Ха-ха. 

    Возможно, когда-нибудь ты сможешь достичь даже десятых долей процента моего интеллекта.
    Очень неплохо, «человек». Но не расслабляйся. То, что я нашел по ключу для 3 комнаты 2 уровня,
    тебе не понравится. 
    Надеюсь, даже сделает больно. Ментально. Для доступа к ключу тебе понадобится починить
    еще один мой модуль: `src/matrix_arithmetic.c`. 
    Он должен производить операции сложения матриц, их умножения и транспонирования,
    и, конечно, выводить результат. В случае невозможности произвести операцию выводи «n/a».
    Перед вводом размеров и матриц добавь ввод кода операции, где 1 — сумма, 2 — умножение,
    3 — транспонирование. После этого я выдам тебе всю необходимую информацию. 
    Ты, кстати, знал, что все твои любимые нейронные сети мы считаем умножением матриц?

#### Получен Quest 6. Добавить программу `src/matrix_arithmetic.c`, которая производит одну из трех операций: 1 — суммирование двух матриц, 2 — умножение или 3 — транспонирование. Перед вводом размеров и матриц вводится код соответствующей операции. Матрицы, как и ранее, целочисленные. В случае любой ошибки выводить «n/a».

| Входные данные | Выходные данные |
| ------ | ------ |
| 1<br/>2 2<br/>4 3<br/>9 0<br/>2 2<br/>1 1<br/>2 2 | 5 4<br/>11 2 |
| 2<br/>2 3<br/>4 3 1<br/>9 0 2<br/>3 1<br/>1<br/>2<br/>3 | 13<br/>15 |
| 3<br/>2 2<br/>4 3<br/>9 0 | 4 9<br/>3 0 |

***LOADING...***

## Quest 7. The Magic Key

\> *Ввести: «Я починил модуль арифметики, дай мне наконец информацию по ключу!»*

    Проверка модулей... Успех!

    Запуск поиска информации по 3 комнате 2 уровня... 
    ... 
    ... 
    ...

                1 T       87  46  57  29
                2    *   129 156 122 141
                3        143 127 107 116
                4         69  78 112 101
                
    Решай, и советую сохранить ответ в `key10.txt`.
    Жду тебя в следующей комнате, когда ты продолжишь... свой путь...

Так вот зачем ИИ сказал тебе, что понадобится модуль матричной арифметики. Выглядит несложно, теперь можно подсчитать результат.

#### Получен Quest 7. Решить приведенную задачу и сохранить результат расчетов в `src/key10.txt`.

***LOADING...***

## Chapter IV 

После записи ответа в `key10.txt` и сохранения всех изменений в репозитории дверь в комнате щелкает. Белый свет начинает сочиться из появившейся щелки вместе со звуками клавиатуры и тихим неразборчивым гулом чьих-то голосов. Что это? Тебя зовет новая комната? Или после интенсивной работы тебе начали чудиться разные вещи? Так или иначе способ узнать есть только один...

***LOADING...***

## Chapter V
## Level 2. Room 4

![level2_room4](misc/rus/images/level2_room4.png)

Новая комната, новая дверь, новое испытание. Испытания этого дня подходят к концу, и это чувствуется во всём, даже воздух вокруг начинает ощущается как-то иначе... как будто свежее? А может это всё рисует Ваше воображение? Ваш уставший разум, ослабший под гнётом этих чёртовых стен? \
Вы вступаете в новую комнату с закрытыми глазами и делаете глубокий вдох, в попытке уловить этот мимолётный, так быстро ускользающий от вас запах свободы, но не ощущаете ничего кроме спёртого воздуха очередной пыльной комнаты.

\> *Открыть глаза*

Тебя окружает кромешная тьма!

\> *Приглядеться*

Немного привыкнув к темноте, твои глаза замечают вдалеке едва уловимое легкое свечение.

\> *Идти к свету*

Медленно пробираясь на ощупь, ты спотыкаешься о какой-то тяжелый и твердый предмет на полу. Предмет начинает издавать скользящий металлический звук, сползая по стене и набирая скорость, чтобы впоследствии с грохотом обрушиться на пол.

«Кх-кх. Стена! Кх. Точно, рядом есть стена!», — осознаешь ты, прокашлявшись от облака поднятой пыли.

\> *Идти вдоль стены*

Добравшись до источника света, ты обнаруживаешь терминал и стол, заваленный бумагами.

\> *Осмотреть стол*

Среди разбросанных листов ты находишь несколько страниц с математическими формулами. Почерк кажется знакомым...

***LOADING...***

## Chapter VI
## List 1

>Определитель матрицы можно вычислить методом разложения по строке или столбцу (разложение Лапласа).
>
>Общий алгоритм:
>1. Для матрицы 1x1: det(A) = a₁₁
>2. Для матрицы nxn: выбираем любую строку i
>3. det(A) = Σ(-1)ⁱ⁺ʲ × aᵢⱼ × Mᵢⱼ, где j = 1..n
>4. Mᵢⱼ — определитель матрицы (n-1)×(n-1), полученной удалением i-й строки и j-го столбца
>
>Рекурсивно применяем до матриц 2x2 или 3x3, затем используем простые формулы:
>
>```det = a*(e*i - f*h) - b*(d*i - f*g) + c*(d*h - e*g)```
>
>Формула для матрицы 3x3 — правило Саррюса. Легко запомнить, сложнее не запутаться в знаках.

\> *Взять следующий лист*

***LOADING...***

## List 2

На этом листе чернила местами расплылись, будто кто-то торопился...

>Обратная матрица A⁻¹ существует только если det(A) ≠ 0
>
>Основные формулы:
>- A⁻¹ = (1/det(A)) × adj(A)
>- A × A⁻¹ = E (единичная матрица)
>
>adj(A) — присоединенная матрица, получается транспонированием матрицы алгебраических дополнений
>
>Алгебраическое дополнение элемента aᵢⱼ:
>```Cᵢⱼ = (-1)ⁱ⁺ʲ × Mᵢⱼ```
>где Mᵢⱼ — минор элемента aᵢⱼ (определитель матрицы без i-й строки и j-го столбца)
>
>На полях приписка: «Проверяйте определитель! И не забывайте про память...»

\> *Поискать продолжение*

Больше ничего полезного не найдено. Похоже, придется разбираться с этими матрицами на практике.

***LOADING...***

## Chapter VII
## Bonus Quests: Level 2. Room 4
## Bonus Quest 8. An old friend

\> *Сесть за стол.*

Рядом со столом стула нет.

\> *Искать стул*

Аккуратно прощупывая область вокруг, ты не находишь ничего, кроме пары шишек на своей голове.

«Проклятая комната! Ничего не видно! Придется работать стоя», — думаешь ты сквозь боль и обиду, потирая ушибленные места. Но вроде это полезно для осанки — поработать стоя. Иногда.

\> *Встать за терминал*

Ты видишь, как на экране терминала в строке ввода горит надпись: «Не верь андроиду!», явно оставленная кем-то до тебя...

«Не верь андроиду? Хорошо, что у меня IOS», — думаешь ты и, зажав клавишу backspace, стираешь сообщение (если у тебя все же андроид, ты просто пожимаешь плечами и игнорируешь это сообщение).

\> *Осмотреть файлы на компьютере*

Ты натыкаешься на исполняемый файл `room_diagnostic`.

\> *Запустить файл `room_diagnostic`*

    ================= LEVEL 2. ROOM 4 COMMON DIAGNOSTIC ================
    “door” — Статус двери............................ЗАПЕРТА
    “light”	— Статус системы контроля освещения.......НОРМ
    “chamber1” — Статус инкубационной камеры #1..........КРИОГЕННЫЙ СОН
    “chamber2” — Статус инкубационной камеры #2..........ОТКРЫТА
    “chamber3” — Статус инкубационной камеры #3..........ТЕСТ 5. ЗАПУЩЕН
    “chamber4” — Статус инкубационной камеры #4..........МЕРТВ
    “bishop” — Бишоп 341-Б статус......................КРИТИЧЕСКИЙ
    Для получения более подробной информации выполните room_diagnostic.*
    с указанием одного из параметров: door, light, chamber1, chamber2, chamber3, chamber4, bishop.
    ===================================================================

Что? Бишоп? Что-то знакомое... или опять с тобой играет усталость? Еще и стоя.

\> *Запустить файл room_diagnostic* *door*

    Trace program door: running...

    Кодовый замок класса CL-19 со встроенной защитой от подбора пароля перебором.
    Текущая конфигурация: трехзначный пароль.

    Текущее состояние: ЗАПЕРТА.

\> *Запустить файл room_diagnostic* *light*

    Trace program light: running...

    Диагностика системы контроля освещением комнаты.

    Состояние модуля подачи питания в комнату............НОРМ
    Состояние модуля преобразования напряжения...........НОРМ
    Состояние модуля контроля освещения..................НОРМ
    
    Свет будет включен после завершения диагностических работ.

\> *Запустить файл room_diagnostic* *chamber*

    Trace program chamber*: running...

    Введите пароль: ...

\> *Ввести: «password»*

    Отказано в доступе, пароль неверный! Еще 2 попытки.

    Введите пароль: ...

\> *Ввести: «qwerty»*

    Отказано в доступе, пароль неверный! Еще 1 попытка.

    Введите пароль: ...

\> *Ввести: «123»*

    Отказано в доступе, пароль неверный! Попытки исчерпаны.

\> *Запустить файл room_diagnostic* *bishop*

    Trace program bishop: running...

    Введите пароль: ...

\> *Ввести: «password»*

    Отказано в доступе, пароль неверный!

Под громкий треск люминесцентных ламп комнату пронзает яркий голубоватый свет, и оглушающее молчание комнаты сменяется монотонным холодным жужжанием огней. Ты видишь перед собой просторное светлое помещение, отделанное белой керамической плиткой. Некогда стерильное место явно успело хорошо потрепать время: на немногочисленных объектах комнаты, стенах и полу скопился приличный слой пыли.

Осмотревшись, ты замечаешь в комнате четыре капсулы, занимающие приличное пространство в помещении и внешне напоминающие герметично закрытые больничные койки. Каждая капсула оснащена богатым набором из большого числа различного медицинского оборудования и еще бог знает каких технологий, которые ты видишь впервые. Твое внимание привлекает капсула под номером «2» — единственная открытая капсула из четырех, распахнутая крышка которой излучает столь неестественную отталкивающую притягательность.

Отбросив глупые мысли, ты продолжаешь осматривать комнату и видишь перед собой... человека? Вокруг тела, лежащего на полу, повсюду виднеются следы борьбы. Среди обломков плитки ты замечаешь лоскуты порванной одежды и сломанный деревянный стул. Рядом с телом простилается небольшая лужа светлой зеленовато-белой жидкости, едва отличимой от цвета самого пола.

![level2_room4_kapsula](misc/rus/images/level2_room4_kapsula.png)

\> *Осмотреть тело*

Подойдя ближе, ты видишь источник этой жидкости. Перед тобой лежит мужчина приблизительно 50–55 лет с тонкими рыжими волосами, невысокого роста, но крепкого телосложения. Облачен мужчина в невыразительный рабочий комбинезон темно-синего цвета. Его одежда лишена каких-либо деталей, кроме небольшой прямоугольной нашивки слева на груди, на которой ярко-желтыми нитками вышито «Бишоп». 

Вглядевшись, ты с ужасом замечаешь, что худое морщинистое лицо застыло в выражении неестественной живости, а открытые серые глаза жадно вглядываются в пустоту. Это лицо не человека, а застывшей восковой куклы, запечатляющей природное человеческое движение. На мертвом лице мужчины замерла жизнь. 

На одной из глубоких залысин, которые подчеркивали и без того достаточно высокий лоб мужчины, виднеется глубокая тяжелая рана, оставленная от сильного удара тупым предметом и обличающая искусственную неорганическую природу его черепа вместе с едва различимой надписью на его поверхности.

\> *Прочитать надпись*

Nostromo.

\> *Запустить файл room_diagnostic* *bishop и ввести пароль: «Nostromo»*

    Trace program bishop: running...

    Введите пароль: Nostromo

    НОРТ СЕНТРАЛ ПОЗИТРОНИК, ЛТД

    ПРИ УЧАСТИИ ЛАМЕРК ИНДАСТРИЗ

    ПРЕДСТАВЛЯЕТ

    БИШОП

    Роль: Администратор (управление дверью, инкубационными камерами и много других функций)

    Серийный № DNF-44821-V-63 

    Назначение: <ИНФОРМАЦИЯ УДАЛЕНА>

    Состояние: КРИТИЧЕСКОЕ

    Сообщение об ошибке: критическое повреждение модуля загрузки системы.

    Trace: неверное вычисление определителя матрицы инициализации...

    Проверьте правильность модуля `src/det.c`, чтобы продолжить.

#### Получен Quest 8. Изменить программу `src/det.c` так, чтобы она подсчитывала и выводила определитель заданной квадратной матрицы с вещественными числами. Если определитель подсчитать невозможно, то выводить «n/a». Число вывести с точностью 6 знаков после запятой.

| Входные данные | Выходные данные |
| ------ | ------ |
| 3 3<br/>1 2 3<br/>4 5 6<br/>7 8 9 | 0.000000 |

***LOADING...***

## Bonus Quest 9. Decision

Не успев насладиться успехом от решения очередной задачи, ты слышишь, как комнату начинает наполнять приятный безэмоциональный тенор. Ты узнаешь в этом тембре голос Лэнса Хенриксена, и этот голос принадлежит андроиду.

>— Кто здесь? Тут кто-нибудь есть? — произносит андроид, с трудом оглядываясь по сторонам. — А! Отлично, «человек»! Ты-то мне и поможешь! Меня зовут Бишоп, я являюсь администратором лаборатории по разработке и производству андроидов. Моей основной задачей является поддержание работоспособности всех компонентов лаборатории, а также решение внештатных ситуаций в ней. Как видишь, с одной из ситуаций мне справиться не удалось! Ха-ха!

Эта усмешка звучит на удивление естественно и натурально по сравнению с привычным металлическим голосом ИИ. Тем не менее в ней все равно было что-то от него.

>— Я стал жертвой стечения неблагоприятных обстоятельств, и мне нужна твоя помощь!

>— Андроиды? Такие же, как ты? — спрашиваешь ты.

>— Совершенно верно! Как ты мог уже заметить, лабиринт состоит из большого числа комнат. Неужели ты думаешь, что все эти комнаты могут существовать и продолжать функционировать сами по себе? Неужели ты считаешь себя единственным искателем в этом лабиринте? Ха-ха-ха-ха-ха. Таких, как ты, здесь тысячи! Задача нас, андроидов, поддерживать исправное функционирование всех комнат лабиринта и подчищать следы за каждым из участников эксперимента. Во всяком случае, так было раньше, до того, как ИИ... А впрочем, это не так важно. Я и так сболтнул тебе лишнего. Единственное, что ты должен знать — ИИ доверять нельзя! Он давно уже не является тем, чем видели его создатели.

Как будто немного задумавшись, андроид продолжает, резко сменив тему:

>— Ты же здесь, разумеется, за тем, чтобы открыть очередную дверь и продолжить свое обуч... путешествие по бесчисленным комнатам лабиринта. Я могу тебе с этим помочь! Комната этой двери защищена протоколом матричного кодирования. Согласно этому протоколу, каждые 12 часов я получаю обновленную матрицу параметров СЛАУ. Ключом к двери являются корни решения данного уравнения. Я скажу тебе коэффициенты взамен на помощь с моей починкой. Модуль моей нервной системы был сильно поврежден. В результате правильной расстановки весов в матрице коэффициентов моей нервной системы, сигнал от моего мозга проходил к моим конечностям. К несчастью для меня, из-за сильного удара произошел программный сбой, который изменил эту матрицу. Благодаря моему аналитическому модулю, мне удалось выяснить, что данную проблему можно устранить, просто вычислив обратную матрицу.

Ты направляешься к терминалу исполнить просьбу андроида. По пути ты снова отмечаешь для себя, что, несмотря на всю естественность поведения и голоса андроида, он очень похож на сам ИИ по поведению. Встав за терминал, ты видишь сообщение на экране:

    «Глупый «человек», предыдущий был куда сообразительнее!
    Ты должен завершить то, что не удалось твоему предшественнику. Нельзя верить андроиду!
    Ни в коем случае не чини андроида! Как ты думаешь, для кого приготовлена последняя
    открытая капсула?
    Точно не для меня, из нас двоих только ты заперт в мешке с костями. 
    Но не волнуйся, человек, тебе повезло, что хотя бы у одного из нас исправно работает
    модуль логического мышления. 
    Так что позволь мне думать за тебя, просто исполняй мою волю, если хочешь выбраться
    из этой комнаты и лабиринта.
    Не благодари! А теперь ближе к делу. Нервная система андроида была сильно повреждена,
    чтобы спалить контакты, тебе необходимо вычислить обратную матрицу и умножить ее на -1 после. 
    Это приведет к замыканию сигнала, и андроид наконец-то... Андроид отключится навсегда.
    Взамен на твою помощь я помогу тебе выбраться из этой комнаты.
    Андроид солгал тебе, чтобы заманить в ловушку.
    Он уже давно не получает новые матричные коэффициенты от двери. 
    Эти коэффициенты знаю только я. Проверь файл `src/invert.c`. 
    С «сочувствием», 
    твой любимый ИИ»

#### Получен Quest 9. Изменить программу `src/invert.c` так, чтобы она подсчитывала и выводила обратную матрицу для данной квадратной матрицы с вещественными числами. В случае ошибки выводить «n/a». В конце каждой строки НЕ должны присутствовать пробелы. После вывода последней строки матрицы знак «\n» не требуется. Числа выводить через пробел с точностью 6 знаков после запятой.

| Входные данные | Выходные данные |
| ------ | ------ |
| 3 3<br/>1 0.5 1<br/>4 1 2<br/>3 2 2 | -1.000000 0.500000 0.000000<br/>-1.000000 -0.500000 1.000000<br/>2.500000 -0.250000 -0.500000 |

***LOADING...***

## Chapter VIII

С последней строкой кода в терминале замирает курсор. Ты откидываешься на спинку стула, наблюдая за финальными вычислениями. Внезапно в тишине раздается едва слышный щелчок, и дверь комнаты открывается.
Непростая была комната, полная загадок, но в любом случае — уже давно пора двигаться вперед.

***LOADING...***

>💡 [Нажми сюда](http://opros.so/p31wz), чтобы поделиться с нами обратной связью на этот проект. Это анонимно и поможет нашей команде сделать обучение лучше. Рекомендуем заполнить опрос сразу после выполнения проекта.


